<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>360度背景 - 月山（高画質版）</title>
<script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
<style>
  html, body { margin: 0; height: 100%; overflow: hidden; background: black; }
</style>
</head>
<body>

<a-scene
  renderer="antialias: true; precision: highp; physicallyCorrectLights: true;"
  vr-mode-ui="enabled: true"
  xr-mode-ui="enabled: true"
>
  <!-- 高解像度の360°画像 -->
  <a-sky id="sky" src="gassan_8k.jpg" rotation="0 -90 0"></a-sky>

  <!-- 視点（ヘッドトラッキング・マウス対応） -->
  <a-entity id="camera" camera look-controls position="0 1.6 0"></a-entity>
</a-scene>

<script>
  document.querySelector('a-scene').addEventListener('loaded', () => {
    const skyEl = document.querySelector('#sky');
    const mesh = skyEl.getObject3D('mesh');

    if (mesh && mesh.material.map) {
      const texture = mesh.material.map;

      // 🔹 高品質フィルタリング設定
      texture.anisotropy = 16;               // 異方性フィルタリング（最大）
      texture.minFilter = THREE.LinearFilter;
      texture.magFilter = THREE.LinearFilter;
      texture.encoding = THREE.sRGBEncoding; // 正確な色表現
      texture.needsUpdate = true;
    }

    // 🔹 レンダラーの高精細設定
    const renderer = document.querySelector('a-scene').renderer;
    if (renderer) {
      renderer.outputEncoding = THREE.sRGBEncoding;     // 色補正
      renderer.toneMapping = THREE.ACESFilmicToneMapping; // 映画的トーン
      renderer.toneMappingExposure = 1.1;
      renderer.setPixelRatio(Math.min(window.devicePixelRatio * 1.5, 3)); // Retina超解像
    }
  });
</script>

</body>
</html>
